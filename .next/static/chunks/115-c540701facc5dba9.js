"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[115],{4362:function(t,e,a){a.d(e,{H:function(){return d},a:function(){return o}});var r=a(7437),i=a(2265),n=a(1072);let s=(0,i.createContext)(void 0),d=t=>{let{children:e}=t,[a,d]=(0,i.useState)(null),[o,u]=(0,i.useState)(null),[c,l]=(0,i.useState)(!0);(0,i.useEffect)(()=>{n.O.auth.getSession().then(t=>{var e;let{data:{session:a}}=t;u(a),d(null!==(e=null==a?void 0:a.user)&&void 0!==e?e:null),l(!1)});let{data:{subscription:t}}=n.O.auth.onAuthStateChange((t,e)=>{var a;u(e),d(null!==(a=null==e?void 0:e.user)&&void 0!==a?a:null),l(!1)});return()=>t.unsubscribe()},[]);let m=async(t,e)=>{if(!t||!e)return{data:null,error:{message:"Email and password are required"}};try{let{data:a,error:r}=await n.O.auth.signInWithPassword({email:t.trim(),password:e});return{data:a,error:r}}catch(t){return{data:null,error:{message:"An unexpected error occurred during sign in"}}}},g=async(t,e)=>{if(!t||!e)return{data:null,error:{message:"Email and password are required"}};try{let{data:a,error:r}=await n.O.auth.signUp({email:t.trim(),password:e});return{data:a,error:r}}catch(t){return{data:null,error:{message:"An unexpected error occurred during sign up"}}}},f=async()=>{try{let{error:t}=await n.O.auth.signOut();t&&(u(null),d(null))}catch(t){u(null),d(null)}};return(0,r.jsx)(s.Provider,{value:{user:a,session:o,loading:c,signIn:m,signUp:g,signOut:f},children:e})},o=()=>{let t=(0,i.useContext)(s);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}},3078:function(t,e,a){a.d(e,{Y:function(){return c},K:function(){return l}});var r=a(7437),i=a(2265),n=a(1072),s=a(3340),d=a(4362);let o=()=>{let{user:t}=(0,d.a)();return{addCategoryWithAuth:async e=>{if(!t)throw Error("User must be authenticated to add categories");let{data:a,error:r}=await n.O.from("categories").insert([{name:e.name,description:e.description,image:e.image,parent_id:e.parentId,user_id:t.id}]).select().single();if(r)throw r;return a},updateCategoryWithAuth:async(e,a)=>{if(!t)throw Error("User must be authenticated to update categories");let r={updated_at:new Date().toISOString()};void 0!==a.name&&(r.name=a.name),void 0!==a.description&&(r.description=a.description),void 0!==a.image&&(r.image=a.image),void 0!==a.parentId&&(r.parent_id=a.parentId);let{data:i,error:s}=await n.O.from("categories").update(r).eq("id",e).eq("user_id",t.id).select().single();if(s)throw s;return i},deleteCategoryWithAuth:async e=>{if(!t)throw Error("User must be authenticated to delete categories");let{error:a}=await n.O.from("categories").delete().eq("id",e).eq("user_id",t.id);if(a)throw a},addItemWithAuth:async e=>{if(!t)throw Error("User must be authenticated to add items");let{data:a,error:r}=await n.O.from("items").insert([{name:e.name,category_id:e.categoryId,stock_status:e.stockStatus,rating:e.rating,valuation:e.valuation,image:e.image,images:e.images,manufacturer:e.manufacturer,year_manufactured:e.yearManufactured,afa_number:e.afaNumber,afa_grade:e.afaGrade,description:e.description,bought_for:e.boughtFor,variations:e.variations,user_id:t.id}]).select().single();if(r)throw r;return a},updateItemWithAuth:async(e,a)=>{if(!t)throw Error("User must be authenticated to update items");let r={updated_at:new Date().toISOString()};void 0!==a.name&&(r.name=a.name),void 0!==a.categoryId&&(r.category_id=a.categoryId),void 0!==a.stockStatus&&(r.stock_status=a.stockStatus),void 0!==a.rating&&(r.rating=a.rating),void 0!==a.valuation&&(r.valuation=a.valuation),void 0!==a.image&&(r.image=a.image),void 0!==a.images&&(r.images=a.images),void 0!==a.manufacturer&&(r.manufacturer=a.manufacturer),void 0!==a.yearManufactured&&(r.year_manufactured=a.yearManufactured),void 0!==a.afaNumber&&(r.afa_number=a.afaNumber),void 0!==a.afaGrade&&(r.afa_grade=a.afaGrade),void 0!==a.description&&(r.description=a.description),void 0!==a.boughtFor&&(r.bought_for=a.boughtFor),void 0!==a.variations&&(r.variations=a.variations);let{data:i,error:s}=await n.O.from("items").update(r).eq("id",e).eq("user_id",t.id).select().single();if(s)throw s;return i},deleteItemWithAuth:async e=>{if(!t)throw Error("User must be authenticated to delete items");let{error:a}=await n.O.from("items").delete().eq("id",e).eq("user_id",t.id);if(a)throw a}}},u=(0,i.createContext)(void 0),c=t=>{let{children:e}=t,[a,d]=(0,i.useState)([]),[c,l]=(0,i.useState)([]),{toast:m}=(0,s.pm)(),{addCategoryWithAuth:g,updateCategoryWithAuth:f,deleteCategoryWithAuth:p,addItemWithAuth:h,updateItemWithAuth:v,deleteItemWithAuth:_}=o();(0,i.useEffect)(()=>{y(),w()},[]);let y=async()=>{try{let{data:t,error:e}=await n.O.from("categories").select("*").order("created_at",{ascending:!0});if(e)throw e;let a=t.map(t=>({id:t.id,name:t.name,description:t.description,image:t.image,parentId:t.parent_id,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at)}));d(a)}catch(t){m({title:"Error",description:"Failed to load categories",variant:"destructive"})}},w=async()=>{try{let{data:t,error:e}=await n.O.from("items").select("*").order("created_at",{ascending:!0});if(e)throw e;let a=t.map(t=>({id:t.id,name:t.name,categoryId:t.category_id,stockStatus:t.stock_status,rating:t.rating,valuation:t.valuation,image:t.image,images:t.images,manufacturer:t.manufacturer,yearManufactured:t.year_manufactured,afaNumber:t.afa_number,afaGrade:t.afa_grade,description:t.description,boughtFor:t.bought_for,variations:t.variations,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at)}));l(a)}catch(t){m({title:"Error",description:"Failed to load items",variant:"destructive"})}},S=async t=>{try{let e=await g(t),a={id:e.id,name:e.name,description:e.description,image:e.image,parentId:e.parent_id,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)};d(t=>[...t,a]),m({title:"Success",description:"Category created successfully"})}catch(t){m({title:"Error",description:"Failed to create category",variant:"destructive"})}},I=async(t,e)=>{try{let a=await f(t,e),r={id:a.id,name:a.name,description:a.description,image:a.image,parentId:a.parent_id,createdAt:new Date(a.created_at),updatedAt:new Date(a.updated_at)};d(e=>e.map(e=>e.id===t?r:e)),m({title:"Success",description:"Category updated successfully"})}catch(t){m({title:"Error",description:"Failed to update category",variant:"destructive"})}},A=async t=>{try{await p(t),d(e=>e.filter(e=>e.id!==t)),l(e=>e.filter(e=>e.categoryId!==t)),m({title:"Success",description:"Category deleted successfully"})}catch(t){m({title:"Error",description:"Failed to delete category",variant:"destructive"})}},b=async t=>{try{let e=await h(t),a={id:e.id,name:e.name,categoryId:e.category_id,stockStatus:e.stock_status,rating:e.rating,valuation:e.valuation,image:e.image,images:e.images,manufacturer:e.manufacturer,yearManufactured:e.year_manufactured,afaNumber:e.afa_number,afaGrade:e.afa_grade,description:e.description,boughtFor:e.bought_for,variations:e.variations,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)};l(t=>[...t,a]),m({title:"Success",description:"Item created successfully"})}catch(t){m({title:"Error",description:"Failed to create item",variant:"destructive"})}},E=async(t,e)=>{try{let a=await v(t,e),r={id:a.id,name:a.name,categoryId:a.category_id,stockStatus:a.stock_status,rating:a.rating,valuation:a.valuation,image:a.image,images:a.images,manufacturer:a.manufacturer,yearManufactured:a.year_manufactured,afaNumber:a.afa_number,afaGrade:a.afa_grade,description:a.description,boughtFor:a.bought_for,variations:a.variations,createdAt:new Date(a.created_at),updatedAt:new Date(a.updated_at)};l(e=>e.map(e=>e.id===t?r:e)),m({title:"Success",description:"Item updated successfully"})}catch(t){m({title:"Error",description:"Failed to update item",variant:"destructive"})}},O=async t=>{try{await _(t),l(e=>e.filter(e=>e.id!==t)),m({title:"Success",description:"Item deleted successfully"})}catch(t){m({title:"Error",description:"Failed to delete item",variant:"destructive"})}};return(0,r.jsx)(u.Provider,{value:{categories:a,items:c,addCategory:S,updateCategory:I,deleteCategory:A,addItem:b,updateItem:E,deleteItem:O},children:e})},l=()=>{let t=(0,i.useContext)(u);if(void 0===t)throw Error("useCollection must be used within a CollectionProvider");return t}},3340:function(t,e,a){a.d(e,{pm:function(){return m}});var r=a(2265);let i=0,n=new Map,s=t=>{if(n.has(t))return;let e=setTimeout(()=>{n.delete(t),c({type:"REMOVE_TOAST",toastId:t})},1e6);n.set(t,e)},d=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{let{toastId:a}=e;return a?s(a):t.toasts.forEach(t=>{s(t.id)}),{...t,toasts:t.toasts.map(t=>t.id===a||void 0===a?{...t,open:!1}:t)}}case"REMOVE_TOAST":if(void 0===e.toastId)return{...t,toasts:[]};return{...t,toasts:t.toasts.filter(t=>t.id!==e.toastId)}}},o=[],u={toasts:[]};function c(t){u=d(u,t),o.forEach(t=>{t(u)})}function l(t){let{...e}=t,a=(i=(i+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...e,id:a,open:!0,onOpenChange:t=>{t||r()}}}),{id:a,dismiss:r,update:t=>c({type:"UPDATE_TOAST",toast:{...t,id:a}})}}function m(){let[t,e]=r.useState(u);return r.useEffect(()=>(o.push(e),()=>{let t=o.indexOf(e);t>-1&&o.splice(t,1)}),[t]),{...t,toast:l,dismiss:t=>c({type:"DISMISS_TOAST",toastId:t})}}},1072:function(t,e,a){a.d(e,{O:function(){return s}});var r=a(7557);let i="https://iglyuczpxkkgdemsauup.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlnbHl1Y3pweGtrZ2RlbXNhdXVwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4NTg3MTIsImV4cCI6MjA2NTQzNDcxMn0.LgtSGVSh0qReuL9PGxDeD935BKJXbVQ1JwMzvbSuPCY";if(!i||!n)throw Error("Supabase environment variables are not set. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in your environment.");let s=(0,r.eI)(i,n)},3448:function(t,e,a){a.d(e,{cn:function(){return n}});var r=a(1994),i=a(3335);function n(){for(var t=arguments.length,e=Array(t),a=0;a<t;a++)e[a]=arguments[a];return(0,i.m6)((0,r.W)(e))}}}]);